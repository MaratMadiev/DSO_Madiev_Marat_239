# Требования безопасности (Security NFR)

| ID | Название | Описание | Метрика/Порог | Способ проверки | Компонент | Приоритет |
|----|----------|-----------|---------------|------------------|-----------|-----------|
| **SEC-NFR-001** | Аутентификация пользователей | Система должна надежно аутентифицировать пользователей перед предоставлением доступа к API | • 100% запросов к защищенным эндпоинтам требуют валидного JWT<br>• 0 успешных аутентификаций с неверными credentials<br>• Блокировка после 5 неудачных попыток за 15 минут | • Automated API tests<br>• Security scan (OWASP ZAP)<br>• Log analysis | Auth Service | High |
| **SEC-NFR-002** | Защита паролей | Пароли пользователей должны храниться безопасно | • Хэширование с использованием Argon2id<br>• Минимальная длина пароля: 8 символов<br>• Соль: 16+ байт<br>| • Code review<br>• Password strength tests<br> | Auth Service | High |
| **SEC-NFR-003** | Авторизация по владельцу | Пользователи могут access только свои данные | • 100% запросов к /suggestions/{id} проверяют ownership<br>• 0 успешных access к чужим данным<br>• Все модификации проверяют user_id | • Integration tests<br>• Audit logs | Suggestion Service | High |
| **SEC-NFR-004** | JWT Security | Токены доступа должны быть защищены от компрометации | • TTL access token: 15 минут<br>• TTL refresh token: 7 дней<br>• Алгоритм: RS256<br>• Размер ключа: 2048+ бит | • Token validation tests<br>• Security headers check<br>• JWT library audit | Auth Service | High |
| **SEC-NFR-005** | Защита от brute-force | Система должна защищаться от атак перебором | • Макс. 10 запросов/секунду с IP<br>• Блокировка IP при 100+ failed auth attempts/час<br>• Задержка при неудачной аутентификации: 2 секунды | • Load testing<br>• Security monitoring<br>• Rate limiting tests | API Gateway | Medium |
| **SEC-NFR-006** | Безопасность данных | Конфиденциальные данные должны быть защищены | • Все соединения TLS 1.2+<br>• Шифрование конфиденциальных данных в БД<br>• Никаких sensitive данных в логах | • SSL/TLS scan<br>• Database encryption check<br>• Log audit | Whole System | High |
| **SEC-NFR-007** | Мониторинг безопасности | Система должна детектировать и логировать security events | • Логирование всех failed auth attempts<br>• Alert при 10+ failed attempts/минуту<br>• Audit trail для модераторских действий | • Log analysis<br>• Monitoring dashboard<br>• Alert testing | Monitoring Service | Medium |
| **SEC-NFR-008** | Уязвимости зависимостей | Используемые библиотеки не должны содержать известных уязвимостей | • 0 Critical/High уязвимостей в зависимостях<br>• Регулярное обновление (еженедельно)<br>• Scan всех зависимостей | • Snyk/Safety scan<br>• Dependabot<br>• CI/CD security check | CI/CD Pipeline | Medium |
